<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Src (metrics.Metrics.Src)</title><link rel="stylesheet" href="../../../_odoc_support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../_odoc_support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">metrics</a> &#x00BB; <a href="../index.html">Metrics</a> &#x00BB; Src</nav><header class="odoc-preamble"><h1>Module <code><span>Metrics.Src</span></code></h1><p>Metric sources.</p></header><nav class="odoc-toc"><ul><li><a href="#sources">Sources</a><ul><li><a href="#listing-sources">Listing Sources</a></li></ul></li></ul></nav><div class="odoc-content"><h3 id="sources"><a href="#sources" class="anchor"></a>Sources</h3><div class="odoc-spec"><div class="spec value anchored" id="val-v"><a href="#val-v" class="anchor"></a><code><span><span class="keyword">val</span> v : 
  <span>?doc:string <span class="arrow">&#45;&gt;</span></span>
  <span>?duration:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?status:bool <span class="arrow">&#45;&gt;</span></span>
  <span>tags:<span><span class="type-var">'a</span> <a href="../Tags/index.html#type-t">Tags.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>data:<span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../index.html#type-src">src</a></span></span></code></div><div class="spec-doc"><p><code>v ?doc ~tags name</code> is a new source, accepting arbitrary data points. <code>name</code> is the name of the source; it doesn't need to be unique but it is good practice to prefix the name with the name of your package or library (e.g. <code>&quot;mypkg.network&quot;</code>). <code>doc</code> is a documentation string describing the source, defaults to <code>&quot;undocumented&quot;</code>. <code>tags</code> is the collection if (typed) tags which will be used to tag and index the measure and are used identify the various metrics. The source will be enabled on creation iff one of tag in <code>tags</code> has been enabled with <a href="../index.html#val-enable_tag"><code>enable_tag</code></a>.</p><p>For instance, to create a metric to collect CPU and memory usage on various machines, indexed by <code>PID</code>, <code>host</code> name and <code>IP</code> address:</p><pre class="language-ocaml"><code>let src =
   let ipaddr = Tags.v Ipaddr.pp_hum in
   let tags = Tags.[string &quot;host&quot;; ipaddr &quot;IP&quot; ; int &quot;PID&quot; ; ] in
   let data () = Data.v [float &quot;%CPU&quot; (...); int &quot;MEM&quot; (...); ] in
   Src.v &quot;top&quot; ~tags ~data ~doc:&quot;Information about processess&quot;</code></pre></div></div><h4 id="listing-sources"><a href="#listing-sources" class="anchor"></a>Listing Sources</h4><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span></code><ol><li id="type-t.Src" class="def variant constructor anchored"><a href="#type-t.Src" class="anchor"></a><code><span>| </span><span><span class="constructor">Src</span> : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../index.html#type-src">src</a></span> <span class="arrow">&#45;&gt;</span> <a href="#type-t">t</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The type for metric sources.</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-list"><a href="#val-list" class="anchor"></a><code><span><span class="keyword">val</span> list : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> list</span></span></code></div><div class="spec-doc"><p><code>list ()</code> is the current exisiting source list.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-name"><a href="#val-name" class="anchor"></a><code><span><span class="keyword">val</span> name : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>name src</code> is <code>src</code>'s name.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-doc"><a href="#val-doc" class="anchor"></a><code><span><span class="keyword">val</span> doc : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>doc src</code> is <code>src</code>'s documentation string.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tags"><a href="#val-tags" class="anchor"></a><code><span><span class="keyword">val</span> tags : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string list</span></span></code></div><div class="spec-doc"><p><code>tags src</code> is the list of <code>src</code>'s tag names.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-data"><a href="#val-data" class="anchor"></a><code><span><span class="keyword">val</span> data : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string list</span></span></code></div><div class="spec-doc"><p><code>fields src</code> is the list of <code>src</code>'s data field names. Note that these are updated dynamically, so a monitoring function has to be called first.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal src src'</code> is <code>true</code> iff <code>src</code> and <code>src'</code> are the same source.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span><span class="keyword">val</span> compare : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>compare src src'</code> is a total order on sources.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-duration"><a href="#val-duration" class="anchor"></a><code><span><span class="keyword">val</span> duration : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>duration t</code> is true iff <code>t</code> is a <code>fn</code> source and <code>t</code> requires automatic duration recording.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-status"><a href="#val-status" class="anchor"></a><code><span><span class="keyword">val</span> status : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>status t</code> is true iff <code>t</code> is a <code>fn</code> source and <code>t</code> requires automatic duration recording.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><a href="#type-t">t</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp ppf src</code> prints an unspecified representation of <code>src</code> on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_active"><a href="#val-is_active" class="anchor"></a><code><span><span class="keyword">val</span> is_active : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_active t</code> is true iff <code>t</code> is enabled.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-enable"><a href="#val-enable" class="anchor"></a><code><span><span class="keyword">val</span> enable : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>enable src</code> enables the metric source <code>src</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-disable"><a href="#val-disable" class="anchor"></a><code><span><span class="keyword">val</span> disable : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>disable src</code> disables the metric source <code>src</code>.</p></div></div></div></body></html>